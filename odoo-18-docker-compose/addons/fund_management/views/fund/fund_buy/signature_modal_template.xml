<odoo>
  <template id="signature_modal_template" name="Signature Modal Template">
    <div class="modal fade" id="signatureModal" tabindex="-1" aria-labelledby="signatureModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-fullscreen-lg-down modal-xl modal-dialog-centered">
        <div class="modal-content signature-modal-content">
          <!-- Header -->
          <div class="modal-header signature-modal-header">
            <div class="d-flex align-items-center w-100">
              <div class="signature-modal-icon me-3">
                <i class="fas fa-file-signature"></i>
              </div>
              <div class="flex-grow-1">
                <h4 class="modal-title mb-0" id="signatureModalLabel">
                  <strong>Xác nhận và ký hợp đồng đầu tư</strong>
                </h4>
                <p class="text-muted mb-0 small">Vui lòng xem xét và chọn phương thức ký tên</p>
              </div>
              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Đóng"></button>
            </div>
          </div>

          <!-- Body -->
          <div class="modal-body signature-modal-body p-0">
            <div class="row g-0 h-100">
              <!-- Left Column: PDF Viewer -->
              <div class="col-lg-6 border-end bg-light">
                <div class="p-3 h-100 d-flex flex-column">
                  <div class="d-flex align-items-center mb-2">
                    <div class="bg-white rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 40px; height: 40px;">
                      <i class="fas fa-file-pdf text-danger"></i>
                    </div>
                    <div>
                      <h6 class="mb-0 fw-bold">Hợp đồng đầu tư</h6>
                      <small class="text-muted">Vui lòng xem xét kỹ trước khi ký</small>
                    </div>
                  </div>
                  <div class="card shadow-sm flex-grow-1">
                    <div class="card-body p-0">
                      <embed 
                        id="contract-pdf-viewer"
                        src="/fund_management/static/src/pdf/terms2.pdf#toolbar=1&amp;navpanes=1&amp;scrollbar=1"
                        type="application/pdf"
                        class="w-100" 
                        style="min-height: 400px; border: none;" />
                    </div>
                  </div>
                  <div class="alert alert-info mt-2 mb-0 d-flex align-items-start py-2" role="alert">
                    <i class="fas fa-info-circle me-2 mt-1"></i>
                    <div>
                      <strong class="small">Lưu ý:</strong>
                      <small class="d-block">Vui lòng đọc kỹ toàn bộ hợp đồng trước khi ký tên. Hợp đồng đã ký có giá trị pháp lý.</small>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Right Column: Signature Options -->
              <div class="col-lg-6 bg-white">
                <div class="p-4 h-100 d-flex flex-column">
                  <div class="mb-4">
                    <div class="d-flex align-items-center mb-3">
                      <div class="bg-primary bg-opacity-10 rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 48px; height: 48px;">
                        <i class="fas fa-signature text-primary"></i>
                      </div>
                      <div>
                        <h5 class="mb-0 fw-bold">Chọn phương thức ký tên</h5>
                        <small class="text-muted">Chọn một trong hai phương thức bên dưới</small>
                      </div>
                    </div>
                    
                    <!-- Signature Type Cards -->
                    <div class="row g-3 mb-4">
                      <div class="col-12">
                        <div class="card border-2 signature-type-card active shadow-sm" data-target="hand-sign" style="cursor: pointer; transition: all 0.3s ease;">
                          <div class="card-body">
                            <div class="d-flex align-items-center">
                      <div class="bg-gradient rounded-circle d-flex align-items-center justify-content-center text-white" style="width: 48px; height: 48px; background: linear-gradient(135deg, #ff7a18 0%, #ffb347 100%);">
                        <i class="fas fa-pen-fancy"></i>
                      </div>
                              <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1 fw-bold">Ký tay</h6>
                                <small class="text-muted">Ký tên bằng tay trên màn hình</small>
                              </div>
                              <i class="fas fa-chevron-right text-muted"></i>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-12">
                        <div class="card border-2 signature-type-card shadow-sm" data-target="digital-sign" style="cursor: pointer; transition: all 0.3s ease;">
                          <div class="card-body">
                            <div class="d-flex align-items-center">
                              <div class="bg-gradient rounded-circle d-flex align-items-center justify-content-center text-white" style="width: 48px; height: 48px; background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                <i class="fas fa-certificate"></i>
                              </div>
                              <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1 fw-bold">Ký số</h6>
                                <small class="text-muted">Ký số tự động bằng chứng thư số</small>
                              </div>
                              <i class="fas fa-chevron-right text-muted"></i>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Tab Content -->
                  <div class="tab-content flex-grow-1" id="signatureTabContent" style="min-height: 400px;">
                    <!-- TAB KÝ TAY -->
                    <div class="tab-pane fade show active" id="hand-sign" role="tabpanel">
                      <div class="d-flex flex-column h-100">
                        <div class="alert alert-info d-flex align-items-center mb-3" role="alert">
                          <i class="fas fa-info-circle me-2"></i>
                          <small class="mb-0">Vui lòng ký tên vào ô bên dưới bằng chuột hoặc ngón tay</small>
                        </div>
                        <div class="card mb-3 signature-hand-section">
                          <div class="card-body p-3">
                            <canvas 
                              id="signature-pad"
                              width="800" 
                              height="300"
                              class="w-100 border rounded" 
                              style="cursor: crosshair; touch-action: none; display: block;">
                            </canvas>
                          </div>
                        </div>
                        <div class="d-flex gap-2">
                          <button type="button" class="btn btn-outline-secondary flex-fill" id="clear-signature">
                            <i class="fas fa-eraser me-1"></i>Xóa chữ ký
                          </button>
                          <button type="button" class="btn btn-primary flex-fill" id="submit-signature-hand">
                            <i class="fas fa-check me-1"></i>Xác nhận ký tay
                          </button>
                        </div>
                      </div>
                    </div>

                    <!-- TAB KÝ SỐ -->
                    <div class="tab-pane fade" id="digital-sign" role="tabpanel">
                      <div class="d-flex flex-column h-100">
                        <div class="alert alert-success d-flex align-items-start mb-3" role="alert">
                          <i class="fas fa-shield-alt me-2 mt-1"></i>
                          <div>
                            <strong>Ký số an toàn</strong>
                            <p class="mb-0 small">Hệ thống sẽ thực hiện ký số tài liệu bằng chứng thư số của bạn. 
                            Tài liệu sẽ được ký số tự động và có giá trị pháp lý.</p>
                          </div>
                        </div>
                        <div class="list-group mb-4">
                          <div class="list-group-item border-0 bg-light">
                            <div class="d-flex align-items-center">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Bảo mật cao, mã hóa an toàn</span>
                            </div>
                          </div>
                          <div class="list-group-item border-0 bg-light">
                            <div class="d-flex align-items-center">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Có giá trị pháp lý đầy đủ</span>
                            </div>
                          </div>
                          <div class="list-group-item border-0 bg-light">
                            <div class="d-flex align-items-center">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Xử lý nhanh chóng, tự động</span>
                            </div>
                          </div>
                        </div>
                        <button type="button" class="btn btn-success w-100 btn-lg" id="submit-signature-digital">
                          <i class="fas fa-lock me-2"></i>Ký số ngay
                        </button>
                        <div id="digital-sign-status" class="mt-3 text-center"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Footer -->
          <div class="modal-footer signature-modal-footer">
            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
              <i class="fas fa-times me-1"></i>Đóng
            </button>
          </div>
        </div>
      </div>
    </div>
  </template>
</odoo>

